# PyDetonation-Ultra (PDU) 开发日志

## 项目概述
PyDetonation-Ultra (PDU) 是一个基于 JAX 的可微分爆轰物理模拟引擎。本项目旨在通过可微分编程技术，实现爆轰性能的高精度正向预测与配方的智能逆向设计。

---

## 2026-01-28: V8 引擎里程碑与多相爆轰突破

### 1. 技术背景
在 V7 版本及以前，项目面临“含铝炸药标度失灵（Scale Blindness）”的问题。传统的单相 JCZ3 模型将固体产物（如 $Al_2O_3$、石墨碳）视为高压气体处理。这导致在含铝配方（如 PBXN-109）中，气体的有效体积被高估，能量被“稀释”，预测爆速比实验值偏低约 15%。

### 2. V8 核心升级：气固分离与体积扣除
V8 版本的核心突破是实现了**气固多相平衡模型**：
- **体积扣除法 (Volume Subtraction)**：在计算气相 JCZ3 自由能时，显式扣除固体组分占据的不可压缩体积。
- **物理隔离**：固相产物仅贡献其内能与标准熵，不参与气体分子的碰撞排斥计算。
- **全自洽热力学**：通过对总亥姆霍兹自由能（$A = A_{gas} + A_{solid}$）进行自动微分，获得全自洽的压力 $P$、化学势 $\mu$ 和熵 $S$。

### 3. 关键成果
- **PBXN-109 精度飞跃**：爆速预测从 V7 的 **~6900 m/s** 提升至 **8003 m/s**，完美贴近 8050 m/s 的实验目标。
- **数值稳定性提升**：
    - 全程开启 **FP64 (jax_enable_x64)**，解决了极端压力下 KKT 求解器的 NaN 崩溃问题。
    - 实现了自定义 VJP (Implicit Differentiation)，确保了跨越固相转化的梯度连续性。
- **JWL 拟合增强**：
    - 引入**对数域 MSE**，平衡了爆点（20+ GPa）与膨胀区（< 1 GPa）的拟合精度。
    - 引入 **CJ 锚定惩罚项**，确保拟合曲线严格经过物理爆轰点。

### 4. 项目清理
为了保持项目简洁，我们删除了所有废弃的 V2-V7 迭代脚本，清空了临时备份，进入了以 V8 为核心的生产阶段。

---

## 历史阶段回顾

### Phase 1-7: 基础建设与 V1-V5 迭代
- 搭建了 JAX 基础框架，实现了 NASA 多项式热力学库。
- 引入 JCZ3 参数化模型，初步实现了正向爆轰性能预测。

### Phase 8-10: 性能强化与 V7 标定
- 针对 CHNO 炸药（HMX, RDX, TNT）进行了大规模参数标定。
- 实现了 JWL 的自动拟合流程，打通了从配方到状态方程参数的全流程。

### Phase 11-12: V8 升级与系统维护
- **突破性进展**：攻克了 PBXN-109 的精度难题，奠定了多相物理基础。
- **系统优化**：大规模清理冗余代码，重构了 `RULES.md` 和开发日志。

---

## 未来展望
1. **逆向设计部署**：基于 V8 高精度引擎，正式启动多约束配方反推任务。
2. **AI 加速层**：训练轻量级 MLP 替代复杂的 KKT 迭代，实现亚毫秒级的推理响应。
3. **扩展性增强**：引入更复杂的含能组分（如 CL-20）以及非理想爆轰修正。

**记录人**: Antigravity (Advanced Agentic Coding Agent)
**日期**: 2026-01-28
