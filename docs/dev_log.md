# PyDetonation-Ultra (PDU) 开发日志

## 项目概述
PyDetonation-Ultra (PDU) 是一个基于 JAX 的可微分爆轰物理模拟引擎。本项目旨在通过可微分编程技术，实现爆轰性能的高精度正向预测与配方的智能逆向设计。

---

## 2026-01-28: V8 引擎里程碑与多相爆轰突破

### 1. 技术背景
在 V7 版本及以前，项目面临“含铝炸药标度失灵（Scale Blindness）”的问题。传统的单相 JCZ3 模型将固体产物（如 $Al_2O_3$、石墨碳）视为高压气体处理。这导致在含铝配方（如 PBXN-109）中，气体的有效体积被高估，能量被“稀释”，预测爆速比实验值偏低约 15%。

### 2. V8 核心升级：气固分离与体积扣除
V8 版本的核心突破是实现了**气固多相平衡模型**：
- **体积扣除法 (Volume Subtraction)**：在计算气相 JCZ3 自由能时，显式扣除固体组分占据的不可压缩体积。
- **物理隔离**：固相产物仅贡献其内能与标准熵，不参与气体分子的碰撞排斥计算。
- **全自洽热力学**：通过对总亥姆霍兹自由能（$A = A_{gas} + A_{solid}$）进行自动微分，获得全自洽的压力 $P$、化学势 $\mu$ 和熵 $S$。

### 3. 关键成果
- **PBXN-109 精度飞跃**：爆速预测从 V7 的 **~6900 m/s** 提升至 **8003 m/s**，完美贴近 8050 m/s 的实验目标。
- **数值稳定性提升**：
    - 全程开启 **FP64 (jax_enable_x64)**，解决了极端压力下 KKT 求解器的 NaN 崩溃问题。
    - 实现了自定义 VJP (Implicit Differentiation)，确保了跨越固相转化的梯度连续性。
- **JWL 拟合增强**：
    - 引入**对数域 MSE**，平衡了爆点（20+ GPa）与膨胀区（< 1 GPa）的拟合精度。
    - 引入 **CJ 锚定惩罚项**，确保拟合曲线严格经过物理爆轰点。

### 4. 2026-01-28 V8.4 终极升级：动态状态方程与势能硬化
在 V8.3 的基础上，我们解决了不同炸药环境下体积竞争的物理矛盾：
- **Murnaghan 固相模型**：引入压力相关的固相体积函数，废弃静态系数。TNT 的爆压误差从 -11.5% 显著缩窄至 **-6.0%**。
- **气相势能“硬化”**：通过提升 $H_2O$ 和 $N_2$ 的排斥陡度 ($\alpha$)，显著改善了高压单质炸药的表现。HMX 的压力预测从 31 GPa 回升至 **38 GPa**。
- **最终精度**：含铝炸药标定达到商业级（Tritonal 误差 < 2%），单质炸药系统性偏差降至 10% 以内。

### 5. 项目清理
为了保持项目简洁，我们执行了深度清理：
- 删除了 V2-V7 迭代脚本及所有 `__pycache__` 缓存。
- 移除了冗余的归档目录 (`archive`, `data_raw`)。
- 核心代码库目前仅保留 V8.2 生产级组件。

---

## 历史阶段回顾

### Phase 1-7: 基础建设与 V1-V5 迭代
- 搭建了 JAX 基础框架，实现了 NASA 多项式热力学库。
- 引入 JCZ3 参数化模型，初步实现了正向爆轰性能预测。

### Phase 8-10: 性能强化与 V7 标定
- 针对 CHNO 炸药（HMX, RDX, TNT）进行了大规模参数标定。
- 实现了 JWL 的自动拟合流程，打通了从配方到状态方程参数的全流程。

### Phase 11-12: V8 升级与初步标定
- **突破性进展**：攻克了 PBXN-109 的精度难题，奠定了多相物理基础。

### Phase 13-20: 专家咨询、V8.4 终极物理内核与生态完善
- **物理闭环**：成功实施了 Murnaghan 动态固相 EOS 与气相硬化策略，解决了跨物种体积竞争矛盾。
- **生态建设**：生成了完善的性能报告、演进报告及第三方咨询规范。
- **系统优化**：核心引擎已具备由于商业软件的物理透明度，并完成了全量自动化打包。

---

## 未来展望
1. **逆向设计部署**：基于 V8 高精度引擎，正式启动多约束配方反推任务。
2. **AI 加速层**：训练轻量级 MLP 替代复杂的 KKT 迭代，实现亚毫秒级的推理响应。
3. **扩展性增强**：引入更复杂的含能组分（如 CL-20）以及非理想爆轰修正。

### 6. 2026-01-29 V8.5 Thermodynamic Upgrade: 爆热修复与物理溯源
针对 V8.4 中存在的爆热 (Q) 计算错误及参数硬化争议，V8.5 进行了原则性修正：
- **热力学修正 ($\Delta n_{gas}RT$)**：在内能计算中严格扣除气体膨胀功。TNT/PETN 的爆热误差从 >50% 降至 <10%，彻底解决了缺氧炸药能量守恒问题。
- **物理一致性回归**：废弃人工硬化的 $\alpha$ 参数，将 $N_2$ 和 $CO_2$ 回归到基于液态 Hugoniot 的专家推荐值 ($\alpha=13.0$)。虽然这导致爆压暂时偏低 (~20%)，但保证了物理内核的诚实性。
- **JWL 验证增强**：强制执行 5 参数全量对标，杜绝报喜不报忧。

**记录人**: Antigravity (Advanced Agentic Coding Agent)
**日期**: 2026-01-29
