# PyDetonation-Ultra (PDU): 下一代含能材料爆轰物理计算引擎
## 项目技术白皮书 (Technical Whitepaper)

**版本**: V10.2 "Physics-Enhanced"  
**生成日期**: 2026-01-29  
**定位**: 集成 Miller V2 两阶段铝粉动力学、Ree-Ross 极性修正、JWL 增强约束的深度物理计算平台

---

## 1. 项目愿景与定位

PyDetonation-Ultra (PDU) 旨在解决传统热化学代码（如 Cheetah, EXPLO5）在**非理想炸药**（如含铝 PBX）及**新材料设计**中的局限性。

*   **核心优势**:
    *   **物理优先 (Physics-First)**: V10.2 引入了 **Ree-Ross 偶极矩修正** ($\epsilon_{eff} = \epsilon_0(1 + \alpha\mu^4/k_BT r^6)$)，有效解决极性产物 ($H_2O$, $NH_3$) 的热力学描述。
    *   **动力学耦合 (CMPD)**: 实现了 **Miller V2 两阶段铝粉燃烧模型**（诱导期 + 扩散控制），使非理想炸药的 CJ 参数预测具备真实的物理响应特性。
    *   **JWL 约束增强**: 新增声速正定性检查 ($c^2 > 0$)、曲率约束 ($d^2P/dV^2 > 0$)、膨胀功分段验证，确保拟合参数的物理一致性。

---

## 2. V10.2 核心物理优化实现

### 2.1 Miller V2 两阶段铝粉动力学
```python
# pdu/physics/kinetics.py
@jax.jit
def compute_miller_al_reaction_degree_v2(P, T, D0, residence_time, ...):
    """
    阶段 1 (诱导期): τ_ign = (r0²/3D_eff) * exp(E_a/RT)
    阶段 2 (扩散控制): α = 1 - exp(-k * P^m * t_burn)
    """
```

### 2.2 Ree-Ross 极性修正
```python
# pdu/physics/eos.py
@jax.jit
def compute_polar_epsilon_ree_ross(T, eps0, mu_debye, r_eq, ...):
    """
    εeff = ε0 * (1 + α * μ^4 / (k_B * T * r_eq^6))
    """
```

### 2.3 JWL 约束增强
```python
# pdu/physics/jwl.py - objective 函数新增约束
# (F) 声速正定性: c² = -V² * dP/dV > 0
# (G) 曲率约束: d²P/dV² > 0 (凸性)
# (H) 膨胀功分段验证
```

---

## 3. V10.2 全量标定报告

### 3.1 爆轰性能汇总对标 (D, P, T, Q)

| 炸药 | 爆速 $D$ (m/s) [Err] | 爆压 $P_{CJ}$ (GPa) [Err] | 爆温 $T_{CJ}$ (K) [Err] | 爆热 $Q$ (MJ/kg) [Err] |
| :--- | :---: | :---: | :---: | :---: |
| **HMX** | 8662/9110 (-4.9%) | 39.6/42.0 (-5.8%) | 3541/3800 (-6.8%) | 5.70/6.19 (-7.9%) |
| **RDX** | 8495/8750 (-2.9%) | 34.0/34.7 (-2.2%) | 3513/3600 (-2.4%) | 5.76/5.53 (+4.2%) |
| **PETN** | 8091/8260 (-2.0%) | 32.1/31.5 (+2.0%) | 3723/4503 **(-17.3%)** | 6.20/5.81 (+6.7%) |
| **TNT** | 7229/6930 (+4.3%) | 20.6/21.0 (-1.8%) | 3382/3100 (+9.1%) | 5.03/4.69 (+7.2%) |
| **NM** | 6395/6260 (+2.2%) | 12.0/12.6 (-4.6%) | 3038/3600 **(-15.6%)** | 4.76/4.40 (+8.1%) |
| **Comp B** | 8004/7980 (+0.3%) | 28.7/29.5 (-2.9%) | 3476/3400 (+2.2%) | 5.47/5.10 (+7.3%) |
| **Octol** | 8368/8480 (-1.3%) | 33.2/34.8 (-4.5%) | 3441/3500 (-1.7%) | 5.53/5.60 (-1.2%) |
| **Tritonal** | 7728/6700 **(+15.3%)** | 17.3/25.0 **(-30.8%)** | 3279/3200 (+2.5%) | 10.23/7.50 **(+36.5%)** |
| **PBXN-109** | 8295/8050 (+3.0%) | 19.7/30.0 **(-34.3%)** | 2969/3300 **(-10.0%)** | 9.73/9.70 (+0.4%) |

### 3.2 JWL 详细参数对标

| 炸药 | $A$ (GPa) [Err] | $B$ (GPa) [Err] | $R_1$ [Err] | $R_2$ [Err] | $\omega$ [Err] |
| :--- | :---: | :---: | :---: | :---: | :---: |
| **HMX** | 650.6 **(-16.4%)** | 7.77 (+9.8%) | 4.10 (-2.3%) | 1.010 (+1.0%) | 0.301 (+0.2%) |
| **RDX** | 661.2 **(-15.0%)** | 14.11 **(+99.5%)** | 4.37 (-3.0%) | 1.298 (-7.3%) | 0.252 (+0.8%) |
| **PETN** | 579.2 (-6.1%) | 14.76 **(-12.7%)** | 4.41 (+0.3%) | 1.283 (+6.9%) | 0.249 (-0.3%) |
| **TNT** | 430.5 **(+15.1%)** | 3.08 (-4.6%) | 4.26 (+2.7%) | 0.972 (+8.0%) | 0.299 (-0.4%) |
| **NM** | 234.7 **(-51.9%)** | 4.57 **(-28.1%)** | 4.52 (-9.6%) | 1.265 **(-15.7%)** | 0.297 **(-21.9%)** |
| **Comp B** | 552.1 (+5.4%) | 8.98 **(+16.9%)** | 4.32 (+2.8%) | 1.224 **(+11.2%)** | 0.270 **(-20.5%)** |
| **Octol** | 652.0 (+0.6%) | 6.43 **(-50.3%)** | 4.25 (-5.5%) | 1.008 **(-28.0%)** | 0.300 (+7.2%) |
| **Tritonal** | 515.4 **(+28.9%)** | 2.43 **(-39.4%)** | 4.51 (+0.3%) | 0.992 **(-17.4%)** | 0.294 **(-15.9%)** |
| **PBXN-109** | 807.2 **(-30.2%)** | 7.63 **(-60.7%)** | 4.98 **(-12.7%)** | 1.456 **(+17.2%)** | 0.249 **(+25.1%)** |

---

## 4. V10.2 误差超过 10% 的参数清单 (Critical Deviation Registry)

> [!CAUTION]
> 以下所有参数的绝对误差均超过 10%，是 PDU 引擎在当前物理模型下的核心缺陷，需要专家定向咨询。

### 4.1 爆轰性能参数偏差 (≥ 10%)

| 炸药 | 参数 | PDU 预测 | 实验值 | 偏差 | 物理定位 |
| :--- | :---: | :---: | :---: | :---: | :--- |
| **PETN** | 爆温 $T_{CJ}$ | 3723 K | 4503 K | **-17.3%** | Ree-Ross 修正后的配分函数仍需校准 |
| **NM** | 爆温 $T_{CJ}$ | 3038 K | 3600 K | **-15.6%** | 液相无序结构的热容模型不足 |
| **Tritonal** | 爆速 $D$ | 7728 m/s | 6700 m/s | **+15.3%** | CJ 体积预测偏小，铝粉混合规则 |
| **Tritonal** | 爆压 $P_{CJ}$ | 17.3 GPa | 25.0 GPa | **-30.8%** | Miller 模型的诱导期估计仍不足 |
| **Tritonal** | 爆热 $Q$ | 10.23 MJ/kg | 7.50 MJ/kg | **+36.5%** | 平衡假设将非平衡能计入 |
| **PBXN-109** | 爆压 $P_{CJ}$ | 19.7 GPa | 30.0 GPa | **-34.3%** | HTPB Binder 多相流动未建模 |
| **PBXN-109** | 爆温 $T_{CJ}$ | 2969 K | 3300 K | **-10.0%** | 铝粉放热滞后于 CJ 面 |

### 4.2 JWL 参数偏差 (≥ 10%)

| 炸药 | 参数 | PDU 预测 | 实验值 | 偏差 | 物理定位 |
| :--- | :---: | :---: | :---: | :---: | :--- |
| **HMX** | $A$ | 650.6 GPa | 778.0 GPa | **-16.4%** | CJ 压力起始偏低 |
| **RDX** | $A$ | 661.2 GPa | 778.0 GPa | **-15.0%** | 同上 |
| **RDX** | $B$ | 14.11 GPa | 7.07 GPa | **+99.5%** | PSO 中压区参数漂移 |
| **PETN** | $B$ | 14.76 GPa | 16.90 GPa | **-12.7%** | 等熵线中段采样不足 |
| **TNT** | $A$ | 430.5 GPa | 374.0 GPa | **+15.1%** | 缺氧产物碳团簇异性 |
| **NM** | $A$ | 234.7 GPa | 488.0 GPa | **-51.9%** | 液态起点压力不足 |
| **NM** | $B$ | 4.57 GPa | 6.36 GPa | **-28.1%** | 中压分布失调 |
| **NM** | $R_2$ | 1.265 | 1.5 | **-15.7%** | 误差传递 |
| **NM** | $\omega$ | 0.297 | 0.38 | **-21.9%** | Grüneisen 系数估计偏低 |
| **Comp B** | $B$ | 8.98 GPa | 7.68 GPa | **+16.9%** | 混合物中压线性叠加失调 |
| **Comp B** | $R_2$ | 1.224 | 1.1 | **+11.2%** | 同上 |
| **Comp B** | $\omega$ | 0.270 | 0.34 | **-20.5%** | 绝热指数混合规则不自洽 |
| **Octol** | $B$ | 6.43 GPa | 12.95 GPa | **-50.3%** | HMX/TNT 二元中压输运未建模 |
| **Octol** | $R_2$ | 1.008 | 1.4 | **-28.0%** | 同上 |
| **Tritonal** | $A$ | 515.4 GPa | 400.0 GPa | **+28.9%** | 铝粉能量糊化到爆点 |
| **Tritonal** | $B$ | 2.43 GPa | 4.0 GPa | **-39.4%** | 中压段铝燃烧未纳入 |
| **Tritonal** | $R_2$ | 0.992 | 1.2 | **-17.4%** | 同上 |
| **Tritonal** | $\omega$ | 0.294 | 0.35 | **-15.9%** | 后燃时序响应不足 |
| **PBXN-109** | $A$ | 807.2 GPa | 1157.0 GPa | **-30.2%** | 爆压起始误差传递 |
| **PBXN-109** | $B$ | 7.63 GPa | 19.4 GPa | **-60.7%** | 同上 |
| **PBXN-109** | $R_1$ | 4.98 | 5.7 | **-12.7%** | CJ 体积误差导数传递 |
| **PBXN-109** | $R_2$ | 1.456 | 1.242 | **+17.2%** | 与 $B$ 拟合异常 |
| **PBXN-109** | $\omega$ | 0.249 | 0.199 | **+25.1%** | 膨胀功约束恶化 |

---

## 5. 专家咨询核心课题 (Consultation Objectives for V10.3+)

### 5.1 红色警戒级别 (Critical, |Err| > 30%)

1.  **PBXN-109 爆压 -34.3%**
    *   **现象**: 即使使用 Miller V2 动力学，预测爆压仍仅 19.7 GPa
    *   **咨询课题**: HTPB Binder 在 CJ 面的多相行为如何建模？是否需要显式的颗粒-基体界面模型？

2.  **Tritonal 爆热 +36.5%**
    *   **现象**: 10.23 vs 7.50 MJ/kg，平衡模型将非平衡反应能计入
    *   **咨询课题**: 如何将 Miller 反应度转化为"有效爆热 $Q_{eff}$"？

3.  **Tritonal 爆压 -30.8%**
    *   **现象**: Miller V2 模型改善有限，诱导期估计仍需精细化
    *   **咨询课题**: 颗粒尺寸分布 $f(D_0)$ 如何纳入动力学？

### 5.2 黄色警示级别 (Warning, |Err| 10%-30%)

1.  **PETN/NM 爆温 -15~17%**
    *   **咨询课题**: Ree-Ross 修正后需要重新校准极性分子振动配分函数？

2.  **Tritonal 爆速 +15.3%**
    *   **咨询课题**: 固体铝的体积扣除与团聚细缝混合规则？

3.  **RDX B 参数 +99.5%**
    *   **咨询课题**: PSO 在中压区的"抽象等价"漂移如何约束？

### 5.3 JWL 参数拟合的物理漂移分析

*   **整体结论**: 当 $P_{CJ}$ 起始误差超过 10% 时，JWL 全套参数呈系统性误差。**JWL 准确度完全依赖于 CJ 点的物理保真度**。
*   **V10.2 改进**: 新增的声速正定性和曲率约束有效防止了非物理解，但无法弥补 CJ 点本身的偏差。

---

## 6. 技术演进历程

| 版本 | 核心突破 | 关键改善 |
|:---|:---|:---|
| V8.5 | $\Delta n_{gas} RT$ 修正 | TNT 爆热误差 >50% → <10% |
| V8.6 | Stiff-Mix 高压修正 | HMX $P_{CJ}$ 误差 → -1.5% |
| V9.0 | Partial Reaction 双参数 | Tritonal $\omega$ 0.06 → 0.33 |
| V10.0 | Francis Ree + PSO | 全量 9 种炸药收敛 |
| V10.1 | CMPD 架构 | NM 爆速误差 → +0.9% |
| **V10.2** | **Miller V2 + Ree-Ross + JWL 约束** | **NM 爆压 -7.0% → -4.6%** |

---

## 7. V10.3+ 技术路线图

### 7.1 物理层：多尺度动力学耦合
*   引入粒径分布 $f(D_0)$ 与时序蔓延函数 $\tau(P, T, D_0)$

### 7.2 数据层：密度修正衍生
*   将 $r^*(\rho)$ 扩展为 $\epsilon(\rho)$ 级别

### 7.3 算法层：JWL 曲线约束
*   引入曲率惩罚替代点坐标锚定

---

## 8. 总结

V10.2 "Physics-Enhanced" 版本在 V10.1 基础上进一步优化了物理模型：

**核心交付**:
- Miller V2 两阶段铝粉动力学（诱导期 + 扩散控制）
- Ree-Ross 偶极矩修正
- JWL 声速正定性与曲率约束

**性能改善**:
- NM 爆压: -7.0% → **-4.6%** ↑
- RDX 爆压: -3.4% → **-2.2%** ↑
- HMX 爆速: -5.4% → **-4.9%** ↑

**剩余核心缺陷** (需专家咨询):
- 含铝炸药爆压 -30%+
- 液态炸药爆温 -15%+
- JWL $B$ 参数中压区漂移

**记录人**: Antigravity  
**日期**: 2026-01-29
