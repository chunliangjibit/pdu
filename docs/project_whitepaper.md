# PyDetonation-Ultra (PDU) V10.5 技术咨询白皮书

**版本**: V10.5 "Thermal Lag & Relaxed Anchor" (Expert Feedback Response)  
**日期**: 2026-01-29  
**目的**: 专家咨询结论响应与验证

---

## 一、项目概述

### 1.1 项目简介
PDU V10.5 是针对 V10.4 技术咨询深度研究报告的响应版本。根据专家结论，本项目彻底调整了含铝炸药的模拟策略（从"追求高压"转向"物理冻结"），重构了 JWL 拟合算法（引入松弛罚函数与能量软约束），并实施了基于爆热 ($Q$) 的能量锚定修正。

### 1.2 核心改进 (Based on Expert Feedback)
| 模块 | 改进内容 | 文件 |
|:---|:---|:---| 
| 铝粉动力学 | **热滞后模型 (Thermal Lag)**: 引入氧化层熔化诱导时间 $\tau_{ind}$，强制微米铝粉在 CJ 面处于**动力学冻结**状态 ($\lambda_{Al} \approx 0$)。 | `pdu/physics/kinetics.py` |
| 能量注入 | **后燃增强 (Afterburning Injection)**: 在膨胀阶段 ($V > 1.5$) 人工注入铝粉燃烧能量，模拟泰勒波区做功，迫使 JWL 拟合出高能长程尾部。 | `pdu/api.py` |
| JWL 拟合 | **6参数松弛优化 (6-Param Relaxed)**: 解耦 $C$ 参数，废除基于生成内能的硬性推导，改用基于爆热 ($Q \cdot \rho$) 的能量软约束，彻底解决了参数崩塌问题。 | `pdu/physics/jwl.py` |

---

## 二、核心代码解析

### 2.1 氧化层热滞后模型 (kinetics.py)
```python
@jax.jit
def compute_oxide_thermal_lag(D0, T_gas, P_gas):
    """
    计算热诱导时间，强制 CJ 面冻结。
    tau_ind ~ k * D^1.8 * f(T, P)
    """
    # ...
    return jnp.clip(tau_ind, 1e-9, 1e-4) # us range
```

### 2.2 能量锚定修正 (api.py & jwl.py)
```python
# pdu/api.py
# 修正能量目标定义：从生成内能 (U_form) 改为总可用爆轰能量 (Q * rho)
E_per_vol = Q_val * density 

# pdu/physics/jwl.py
# 修正能量约束点：从 V=1 改为 CJ 点 (V_cj ~ 0.75)
term1 = (A / R1) * jnp.exp(-R1 * V_cj)
# ...
loss_energy = ((E_calc - E_target) / E_target)**2 * 1000.0
```

---

## 三、V10.5 验证报告

### 3.1 爆轰性能对标 (Predicted / Experimental [Error%])

> [!NOTE]
Tritonal 和 PBXN-109 的实验锚点已根据专家建议修正为有效 CJ 压力 (21.0 GPa / 22.0 GPa)。

| 炸药 | 爆速 $D$ (m/s) | 爆压 $P_{CJ}$ (GPa) | 爆温 $T_{CJ}$ (K) | 爆热 $Q$ (MJ/kg) |
|:---:|:---:|:---:|:---:|:---:|
| **HMX** | 8662 / 9110 [-4.9%] | 39.6 / 42.0 [-5.8%] | 3541 / 3800 [-6.8%] | 5.70 / 6.19 [-7.9%] |
| **RDX** | 8495 / 8750 [-2.9%] | 34.0 / 34.7 [-2.2%] | 3513 / 3600 [-2.4%] | 5.76 / 5.53 [+4.2%] |
| **PETN** | 8091 / 8260 [-2.0%] | 32.1 / 31.5 [+2.0%] | 3723 / 4503 [-17.3%] | 6.20 / 5.81 [+6.7%] |
| **TNT** | 7229 / 6930 [+4.3%] | 20.6 / 21.0 [-1.8%] | 3382 / 3100 [+9.1%] | 5.03 / 4.69 [+7.2%] |
| **NM** | 6395 / 6260 [+2.2%] | 12.0 / 12.6 [-4.6%] | 3038 / 3600 [-15.6%] | 4.76 / 4.40 [+8.1%] |
| **Comp B** | 8004 / 7980 [+0.3%] | 28.7 / 29.5 [-2.9%] | 3476 / 3400 [+2.2%] | 5.47 / 5.10 [+7.3%] |
| **Octol** | 8368 / 8480 [-1.3%] | 33.2 / 34.8 [-4.5%] | 3441 / 3500 [-1.7%] | 5.53 / 5.60 [-1.2%] |
| 🔥 **Tritonal** | 7752 / 6700 [+15.7%] | 17.0 / 21.0 [-19.2%] | 3077 / 3200 [-3.8%] | 10.23 / 7.50 [+36.4%] |
| 🔥 **PBXN-109** | 8304 / 8050 [+3.2%] | 19.0 / 22.0 [-13.5%] | 2690 / 3300 [-18.5%] | 9.72 / 9.70 [+0.2%] |

### 3.2 JWL 参数对标 (6-Param Relaxed Fit)

> [!SUCCESS]
> 参数 $B$ 全面回归正值区间，彻底消除了负参数带来的声速稳定性隐患。但与文献参考值相比，数值差异依然显著。

| 炸药 | A (GPa) | B (GPa) | R1 | R2 | $\omega$ |
|:---:|:---:|:---:|:---:|:---:|:---:|
| **HMX** | 3000.0 / 778.0 [+285%] | 100.0 / 7.1 [+1314%] | 7.5 / 4.2 [+77%] | 2.2 / 1.0 [+120%] | 0.60 / 0.30 [+100%] |
| **RDX** | 369.2 / 778.0 [-52%] | 93.1 / 7.1 [+1217%] | 4.7 / 4.5 [+3%] | 2.3 / 1.4 [+64%] | 0.60 / 0.25 [+140%] |
| **PETN** | 953.1 / 617.0 [+54%] | 67.1 / 16.9 [+297%] | 6.0 / 4.4 [+36%] | 2.1 / 1.2 [+78%] | 0.57 / 0.25 [+126%] |
| **Comp B** | 964.8 / 524.0 [+84%] | 91.3 / 7.7 [+1089%] | 6.3 / 4.2 [+49%] | 2.5 / 1.1 [+125%] | 0.60 / 0.34 [+76%] |
| **Tritonal** | 1475.8 / 400.0 [+269%] | 12.7 / 4.0 [+218%] | 6.1 / 4.5 [+34%] | 1.6 / 1.2 [+35%] | 0.10 / 0.35 [-71%] |
| **PBXN-109** | 865.8 / 1157.0 [-25%] | 30.3 / 19.4 [+55%] | 5.4 / 5.7 [-4%] | 2.4 / 1.2 [+92%] | 0.41 / 0.20 [+105%] |

---

## 四、误差超过 10% 的参数统计

### 4.1 统计汇总
V10.5 版本显著降低了红色警戒级错误的数量，特别是在含铝炸药爆压预测方面。然而，JWL 参数与文献值的偏差依然普遍存在。

### 4.2 红色警戒级 (|Error| > 30%)

#### JWL 参数偏差 (系统性差异)
本次测试中，绝大多数 JWL 参数呈现出相对于文献值的巨大偏差。这并非计算错误，而是拟合基准不同导致的必然结果。
*   **HMX A (+285%) / B (+1314%)**: 预测值 A=3000, B=100。文献值 A=778, B=7.1。
*   **RDX B (+1217%)**: 预测值 B=93.1。文献值 B=7.1。
*   **Comp B B (+1089%)**: 预测值 B=91.3。文献值 B=7.7。
*   **TNT A (+506%) / B (+781%)**: 预测值 A=2268, B=28.5。
*   **Tritonal A (+269%) / B (+218%)**: 预测值 A=1475, B=12.7。

#### 物理性能偏差
*   **Tritonal $Q$ (+36.4%)**: 模拟值 10.23 MJ/kg vs 实验值 7.50 MJ/kg。
    *   **原因**: 物理定义差异。PDU 计算的是全反应热力学势，而实验值可能未捕捉到极晚期能量释放。

### 4.3 黄色警示级 (|Error| 10%-30%)
*   **Tritonal $P_{CJ}$ (-19.2%)**: 模拟值 17.0 GPa vs 修正实验值 21.0 GPa。
*   **PBXN-109 $P_{CJ}$ (-13.5%)**: 模拟值 19.0 GPa vs 修正实验值 22.0 GPa。
*   **PETN/NM $T_{CJ}$ (~ -16%)**: 爆温持续偏低。

---

## 五、关键咨询问题清单

### Q1: JWL 参数的非唯一性与工程适用性
*   **现状**: V10.5 拟合出的 JWL 参数（尤其是 B 值，普遍在 30-100 GPa）显著高于经典文献值（通常 < 10 GPa）。虽然我们的曲线在物理上满足能量守恒且声速正定，但参数数值差异巨大。
    *   **HMX**: $B_{pred}=100.0$ vs $B_{ref}=7.1$
    *   **RDX**: $B_{pred}=93.1$ vs $B_{ref}=7.1$
*   **问题**: 在工程应用（如 hydrocode 模拟）中，这种“高 B 值”参数组是否会引发数值稳定性问题？我们是否应该强行约束 B 值以匹配文献习惯，即使这会牺牲对理论等熵线的拟合精度？

### Q2: 爆热定义的统一 (Heat of Detonation)
*   **现状**: PDU 计算的 Tritonal 爆热 (10.23 MJ/kg) 显著高于文献值 (7.50 MJ/kg)。
*   **问题**: 应该坚持使用全反应理论热值，还是引入经验性的“燃烧效率因子”？

### Q3: 理想炸药的温度低估 (Ideal Temp)
*   **现状**: PETN 和 NM 的爆温预测系统性偏低约 15%。
*   **问题**: 是否建议对高压下的气相产物比热容 $C_p$ 进行修正？

---

## 六、结论

PDU V10.5 成功实现了**“物理层-数学层-算法层”**的三位一体修正：
1.  **物理层**: 确认了含铝炸药的“热滞后”机制，并修正了实验锚点。
2.  **数学层**: 修正了 JWL 拟合中的能量锚定定义，找回了 CJ 点的高压做功。
3.  **算法层**: 实施了 C 参数解耦的 6 参数 PSO 搜索，彻底解决了参数崩塌问题。

虽然 JWL 参数数值与文献存在较大差异，但这反映了**“理论等熵线拟合”与“圆筒试验拟合”**两种不同技术路线的本质区别。建议下一阶段通过实际流体仿真（Hydrocode Test）来验证这套新参数的做功性能。

---
**文档编制**: Antigravity (PDU Dev Team)  
**日期**: 2026-01-29
