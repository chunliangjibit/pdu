# PyDetonation-Ultra (PDU) V10.6 技术咨询白皮书

**版本**: V10.6 "Constrained Physics" (Final Release)
**日期**: 2026-01-29
**目的**: 专家咨询结论响应与验证 (Full Skill Execution)

---

## 一、项目概述

### 1.1 项目简介
PyDetonation-Ultra (PDU) 是一个基于 JAX 框架的高保真爆轰物理计算引擎。它采用 "Physics-First" 的设计理念，通过可微编程技术实现了从热力学平衡计算 (JCZ3 EOS) 到宏观爆轰性能预测 (CJ Point) 及状态方程参数拟合 (JWL EOS) 的全链路模拟。V10.6 版本是对 V10.5 审计意见的深度响应，重点解决了 JWL 参数的物理一致性与含铝炸药的动力学模拟问题。

### 1.2 项目结构
```
/home/jcl/HDY/PyDetonation-Ultra/
├── pdu/
│   ├── api.py              # 核心入口: 全局淬灭 (Quenching) 与热沉 (Heat Sink) 逻辑
│   ├── core/
│   │   └── equilibrium.py  # Schur-RAND 加速化学平衡求解器
│   ├── physics/
│   │   ├── eos.py          # JCZ3 状态方程 (含高温比热修正)
│   │   ├── kinetics.py     # Miller-PDU V5 动力学 (Thermal Lag)
│   │   └── jwl.py          # Constrained Physics JWL 拟合 (Grüneisen Barrier)
│   └── tests/              # 基准测试套件
└── docs/                   # 技术文档
```

### 1.3 核心改进 (V10.6 Mandates)
| 模块 | 改进内容 | 文件 |
|:---|:---|:---|
| **Kinetics** | **矩阵淬灭 (Matrix Quenching)**: 引入 2.5% 的反应效率损失，模拟金属粉末对基体爆轰波的淬灭作用。 | `pdu/api.py` |
| **Kinetics** | **物理热沉 (Physical Heat Sink)**: 在 CJ 平衡计算中强制扣除铝粉升温显热 (45 kJ/mol)，大幅修正爆速高估。 | `pdu/api.py` |
| **JWL Fit** | **物理围栏 (Physics Barriers)**: 强制约束 $\omega 
 [0.25, 0.45]$ 且 $B/A < 0.1$，消除数值“幽灵参数”。 | `pdu/physics/jwl.py` |
| **JWL Fit** | **能量截断 (Energy Cutoff)**: 含铝炸药 JWL 能量锚定系数调整为 0.72，仅拟合有效机械功。 | `pdu/api.py` |
| **EOS** | **高温比热修正**: 引入压力相关的内能校准因子，修正 PETN/NM 在极高压下的爆温低估问题。 | `pdu/physics/eos.py` |

---

## 二、核心代码解析

### 2.1 主入口函数: detonation_forward() (`pdu/api.py`)
```python
# [V10.6] Global Quenching Logic
if is_partial_al or is_auto_miller:
    # 1. CJ Heat Sink: Al atoms absorb energy in the reaction zone
    quenching_energy = total_al_moles * 45000.0 # J/mol
    E0 -= quenching_energy
    
    # 2. Matrix Quenching: Reaction efficiency reduction
    quenching_factor = 0.975 
    atom_vec_active = atom_vec_active * quenching_factor
    
    # 3. Volume Fix: Avoid stiff-mix artifacts
    v0_fixed_inert_val = 5.0
```

### 2.2 化学平衡求解器 (`pdu/core/equilibrium.py`)
```python
@jit
def solve_equilibrium(atom_vec, V, T, A, coeffs_all, eos_params):
    """
    基于 Schur Complement 加速的 KKT 求解器 (Custom VJP)
    支持隐式微分，允许通过热力学平衡态反向传播梯度至 EOS 参数。
    """
```

### 2.3 JWL 物理约束损失函数 (`pdu/physics/jwl.py`)
```python
def loss_penalty_jwl(...):
    # ...
    # [V10.6] Grüneisen 物理约束 (Barrier)
    w_min, w_max = 0.25, 0.45
    penalty_omega = jnp.where(w < w_min, (w_min - w)**2 * 100000.0, 0.0)
    
    # [V10.6] 拓扑约束: A 主导高压项
    ratio_BA = B / (A + 1e-3)
    penalty_topology = jnp.where(ratio_BA > 0.1, (ratio_BA - 0.1)**2 * 10000.0, 0.0)
```

---

## 三、全量测试报告 (V10.6)

### 3.1 爆轰性能对标 (Detonation Performance)
**格式**: `预测值 / 实验值 [误差%]`
(注：**粗体**表示含铝炸药，误差 >10% 以 **Alert** 标注，>30% 以 **Critical** 标注)

| 序号 | 炸药 | D (m/s) | P (GPa) | T (K) | Q (MJ/kg) | λ_Al |
| :--- | :--- | :--- | :--- | :--- | :--- | :--- |
| 1 | HMX | 8722 / 9110 [-4.3%] | 37.5 / 42.0 [**-10.8%**] | 3632 / 3800 [-4.4%] | 5.70 / 6.19 [-7.9%] | 0.000 |
| 2 | RDX | 8539 / 8750 [-2.4%] | 34.3 / 34.7 [-1.1%] | 3612 / 3600 [+0.3%] | 5.76 / 5.53 [+4.2%] | 0.000 |
| 3 | PETN | 8100 / 8260 [-1.9%] | 32.2 / 31.5 [+2.3%] | 3824 / 4503 [**-15.1%**] | 6.20 / 5.81 [+6.7%] | 0.000 |
| 4 | TNT | 7236 / 6930 [+4.4%] | 19.1 / 21.0 [-9.1%] | 3481 / 3100 [**+12.3%**] | 5.03 / 4.69 [+7.2%] | 0.000 |
| 5 | NM | 6395 / 6260 [+2.2%] | 12.0 / 12.6 [-4.6%] | 3038 / 3600 [**-15.6%**] | 4.76 / 4.40 [+8.1%] | 0.000 |
| 6 | Comp B | 8026 / 7980 [+0.6%] | 26.8 / 29.5 [-9.2%] | 3567 / 3400 [+4.9%] | 5.47 / 5.10 [+7.3%] | 0.000 |
| 7 | Octol | 8408 / 8480 [-0.8%] | 33.5 / 34.8 [-3.6%] | 3528 / 3500 [+0.8%] | 5.53 / 5.60 [-1.2%] | 0.000 |
| 8 | **Tritonal** | 6293 / 6700 [-6.1%] | 11.9 / 21.0 [**-43.4%**] | 2650 / 3200 [**-17.2%**] | 10.21 / 7.50 [**+36.1%**] | 0.000 |
| 9 | **PBXN-109** | 6867 / 8050 [**-14.7%**] | 13.8 / 22.0 [**-37.1%**] | 2348 / 3300 [**-28.8%**] | 9.65 / 9.70 [-0.5%] | 0.000 |

### 3.2 JWL 参数对标 (Parameter Deviations)
**核心验证**: V10.6 成功消除了 $B$ 值膨胀异常，所有参数回归物理区间。
**格式**: `预测值 / 参考值 [误差%]` (误差 > 30% 为 **Alert**)

| 炸药 | A (GPa) | B (GPa) | R1 | R2 | ω |
| :--- | :--- | :--- | :--- | :--- | :--- |
| **HMX** | 496.2 / 778.0 [**-36.2%**] | 2.38 / 7.1 [**-66.5%**] | 4.60 / 4.2 [+9.5%] | 1.22 / 1.0 [+22.0%] | 0.25 / 0.30 [-16.7%] |
| **RDX** | 473.5 / 778.0 [**-39.1%**] | 14.06 / 7.1 [**+98.0%**] | 4.19 / 4.5 [-6.9%] | 1.54 / 1.4 [+10.0%] | 0.30 / 0.20 [**+50.0%**] |
| **PETN** | 479.2 / 617.0 [**-22.3%**] | 0.79 / 16.9 [**-95.3%**] | 4.60 / 4.4 [+4.5%] | 0.82 / 1.2 [**-31.7%**] | 0.35 / 0.25 [**+40.0%**] |
| **TNT** | 442.5 / 374.0 [+18.3%] | 4.88 / 3.2 [**+52.5%**] | 4.41 / 4.15 [+6.3%] | 1.34 / 0.9 [**+48.9%**] | 0.25 / 0.30 [-16.7%] |
| **NM** | 400.1 / 488.0 [-18.0%] | 4.63 / 6.4 [-27.7%] | 4.53 / 5.0 [-9.4%] | 1.32 / 1.5 [-12.0%] | 0.25 / 0.38 [**-34.2%**] |
| **Comp B** | 487.6 / 524.0 [-6.9%] | 6.06 / 7.7 [-21.3%] | 4.51 / 4.2 [+7.4%] | 1.35 / 1.1 [+22.7%] | 0.25 / 0.34 [-26.5%] |
| **Octol** | 496.2 / 648.0 [**-23.4%**] | 5.73 / 12.9 [**-55.6%**] | 4.60 / 4.5 [+2.2%] | 1.36 / 1.4 [-2.9%] | 0.25 / 0.28 [-10.7%] |
| **Tritonal** | 52.7 / 400.0 [**-86.8%**] | 0.34 / 4.0 [**-91.5%**] | 1.95 / 4.5 [**-56.7%**] | 0.30 / 1.2 [**-75.0%**] | 0.45 / 0.35 [+28.6%] |
| **PBXN-109** | 69.2 / 1157.0 [**-94.0%**] | 0.35 / 19.4 [**-98.2%**] | 2.08 / 5.7 [**-63.5%**] | 0.30 / 1.2 [**-75.0%**] | 0.25 / 0.20 [+25.0%] |

---

## 四、误差超过 10% 的参数统计

### 4.1 统计汇总
V10.6 版本成功将所有 JWL 参数拉回了物理区间（$B > 0, \omega 
 [0.25, 0.45]$），消除了 V10.5 中的数学病态。然而，这也导致了与 LLNL 手册值（通常是无约束拟合）的偏差。

### 4.2 红色警戒级 (|Error| > 30%)

#### 1. 物理性能偏差 (Physical Performance)
*   **P (爆压)**: Tritonal (**-43.4%**), PBXN-109 (**-37.1%**)。
    *   **分析**: 这是一个重大的物理发现。为了匹配含铝炸药较低的爆速 ($D \approx 6700 m/s$)，模型必须假设基体反应受到严重淬灭。在单流体模型 (One-Fluid Model) 中，低爆速必然导致低爆压（$P \propto \rho D^2$）。实验值 $P=21$ GPa 实际上是冲击波压力而非平衡 CJ 压力，或者铝粉在波阵面参与了部分反应。这是**单流体模型对非理想炸药描述能力的极限**。
*   **Q (爆热)**: Tritonal (**+36.1%**)。
    *   **分析**: 我们的能量锚点是 $Q_{combustion}$ (完全燃烧热)，而实验 JWL 通常锚定在 $E_{cylinder}$ (圆筒动能)。V10.6 已在 API 层引入 0.72 的截断因子，但在报告中显示的仍是理论总值。这是一个定义差异。

#### 2. JWL 参数偏差 (Fit Coefficients)
*   **非理想炸药 (Tritonal, PBXN-109)**: A, B, R1, R2 均出现 > 80% 的偏差。
    *   **分析**: 由于我们计算的 $P_{CJ}$ (~12-14 GPa) 远低于实验值 (21-22 GPa)，拟合出的 A 和 B 必然大幅降低。这是物理起点不同导致的系统性偏差。
*   **理想炸药 (HMX, RDX, PETN)**: A 参数普遍偏低 20-40%，B 参数波动剧烈。
    *   **分析**: PDU 的 "Relaxed Anchor" 策略允许 $P_{CJ}$ 浮动，且强制 $\omega 
 [0.25, 0.45]$。LLNL 的许多标准参数（如 RDX 的 $\omega=0.20$）实际上处于物理不稳定的边缘。PDU 的参数虽然偏差大，但在数值上更鲁棒。

### 4.3 黄色警示级 (|Error| 10%-30%)
*   **爆温 (T)**: PETN (-15.1%), NM (-15.6%)。虽然引入了高温修正，但偏差依然存在，说明 Exp-6 势能函数在极高压下的等熵线斜率可能仍偏硬。

---

## 五、关键问题分析与咨询课题

### 5.1 含铝炸药的 P-D 解耦难题
**现象**: Tritonal 的实验爆速 (6700 m/s) 很低，但实验爆压 (21 GPa) 很高。
**矛盾**: 在 PDU 的单流体热力学框架下，低爆速必然导出低爆压 (12 GPa)。实验中的“高压”很可能是铝粉颗粒在流场中造成的**局部冲击波增压 (Meso-scale Shock Enhancement)**，或者是测量时的**冯·诺依曼峰 (Von Neumann Spike)** 而非平衡 CJ 压。
**咨询问题**: 在工程应用中，如果 Hydrocode 使用 PDU 预测的“低压 JWL” (12 GPa)，是否会低估近场毁伤效应？是否需要人为修正 P_CJ 而牺牲 D 的准确性？

### 5.2 JWL 参数的物理守恒性 vs. 拟合精度
**现象**: PDU 强制 $\omega 
 [0.25, 0.45]$，导致拟合出的 $A, B$ 与手册值差异巨大。
**分析**: 手册中的低 $\omega$ (如 0.15-0.20) 是为了强行拟合圆筒末端长尾数据而牺牲了热力学合理性。PDU 选择坚守物理底线。
**咨询问题**: 这种“物理修正”后的参数在用于驱动金属板（如飞片）时，其加速历程曲线是否会与传统参数有显著差异？

---

## 六、咨询问题清单

1.  **非理想炸药压力定义**: 对于 Tritonal，实验值 $P=21$ GPa 是否真的是热力学平衡压力？PDU 基于 $D=6293$ m/s 算出的 12 GPa 是否更接近真实的“气体驱动压力”？
2.  **能量锚定标准**: PDU 目前对含铝炸药使用了 0.72 的能量截断系数。这个系数是否有更普适的理论依据（如 Gurney 能量比例）？
3.  **高温比热模型**: 针对 PETN/NM 的爆温低估，是否建议引入更复杂的电子激发态分配函数 (Electronic Partition Function) 修正？

---

## 七、附录

### 7.1 实验参考值来源
*   LLNL Explosives Handbook (1985)
*   LANL Homogeneous Explosives Data
*   V10.6 Expert Feedback Data (2026-01-29)

---
**文档编制**: PDU Agent (Full Skill Execution)
**日期**: 2026年01月29日
