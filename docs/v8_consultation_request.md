# 爆轰物理模拟引擎 V8 版本技术咨询需求书

## 1. 项目背景与程序定位
PyDetonation-Ultra (PDU) 是一款基于 **JAX 可微分编程** 开发的高保真爆轰物理计算引擎。目前程序已演进至 **V8 版本**，核心逻辑采用了基于 JCZ3 状态方程的多相平衡模型（包含气固分离与体积扣除算法）。

程序旨在实现：
1. **正向高精度预测**：通过输入成分，自动计算 CJ 点、等熵线及 JWL 参数。
2. **逆向配方设计**：利用 JAX 的自动微分能力，通过性能目标反推最优配方。

---

## 2. 当前技术架构 (V8)
- **状态方程 (EOS)**: 采用 JCZ3 (Exp-6) 势能模型。
- **多相逻辑**: 实现气固分离，将 $Al_2O_3$、石墨碳等视为凝聚相，并在气体自由能计算中采用体积扣除法（Volume Subtraction）。
- **计算框架**: FP64 全程精度，基于 KKT 条件的化学平衡求解器（含隐式微分）。

---

## 3. 当前版本存在的核心问题
尽管 V8 引擎在含铝炸药（如 PBXN-109）上取得了重大进步，但在综合验证测试中，仍存在以下关键技术瓶颈：

### 3.1 特定炸药种类的巨大偏差
根据最新的性能报告（详见附件），以下炸药的预测结果无法满足工程精度需求：
- **富碳炸药 (如 TNT, Comp B)**: 爆速预测系统性偏高（误差达 **+10% ~ +22%**）。
- **铝化炸药 (如 Tritonal)**: 虽然物理框架已打通，但爆速预测误差高达 **+22.8%**。
- **液体/单质**: 液体硝基甲烷 (NM) 误差为 **+11.9%**。

### 3.2 爆压系统性偏高
整体爆压（$P_{CJ}$）预测值普遍高于实验值 **10% - 40%**。这表明当前的 JCZ3 势能参数（$\epsilon/k, r^*, \alpha$）在高压区的斥力描述或格林艾森系数（$\omega$）的拟合策略存在偏差。

---

## 4. 咨询目标与技术需求
我们需要第三方专家协助解决以下问题：

1. **势能参数全局优化**: 针对 N2, H2O, CO2, CO 及凝聚相 C, $Al_2O_3$ 的 Exp-6 参数进行协同标定，重点校准富碳和铝化炸药。
2. **多相模型评审**: 评估当前“气固分离+体积扣除”物理模型的适用性，特别是针对爆轰产物中含有大量固体碳时的处理逻辑。
3. **JWL 锚定策略改进**: 建议如何更科学地将拟合的 JWL 曲线与理论计算的 CJ 点进行物理锚定，以消除能量衔接处的奇异性。

---

## 5. 提供的技术支撑材料
我们将提供以下核心文件包（代码部分保留接口说明，具体逻辑见源码）：

### 5.1 核心算法模块
- `pdu/physics/eos.py`: V8 状态方程实现逻辑（包含亥姆霍兹自由能计算）。
- `pdu/core/equilibrium.py`: 多相 KKT 平衡求解器接口及隐式微分实现。
- `pdu/physics/jwl.py`: 基于等熵膨胀线的对数域拟合算法。

### 5.2 数据库与配置
- `pdu/data/jcz3_params.json`: 当前 V8 使用的 JCZ3 势能参数。
- `pdu/data/products.json`: 产物 NASA 多项式热力学数据库。
- `pdu/data/reactants.json`: 反应物及粘结剂（HTPB等）的基础物理数据。

### 5.3 验证与评估工具
- `v8_comprehensive_test.py`: 自动化多维验证脚本。
- `docs/v8_performance_report.md`: 最新的 9 种炸药性能对比报告（数据源）。

---

## 6. 预期产出
1. 一套经过重新标定的、在全浓度范围内更稳定的 JCZ3 势能参数集。
2. 针对 V8 物理模型缺陷的技术诊断报告及改进建议。

**联系人**: [User Name]
**申请日期**: 2026-01-28
