# PyDetonation-Ultra V8.4 技术咨询报告

**日期**: 2026-01-28  
**版本**: V8.4 (JCZ3 Multi-Phase EOS)  
**状态**: 诚实披露 - 请求专家技术指导

---

## 一、项目概述

### 1.1 核心目标

PyDetonation-Ultra 是一个基于 **JAX 可微分编程** 的高保真爆轰性能预测引擎，旨在实现：

1. **正向计算**：给定配方 → 预测爆轰性能（D, P, T, Q, JWL 参数）
2. **逆向设计**：给定性能目标 → 反推最优配方
3. **端到端可微**：支持基于梯度的配方优化

### 1.2 技术路线

```
配方输入 → 等效化学式 → CJ 平衡求解 (JCZ3 EOS) → 等熵膨胀曲线 → JWL 拟合
   ↓                                                          ↓
混合先验融合                                            多参数验证 (D, P, T, Q, JWL)
```

**核心物理引擎**：JCZ3 V8.4 (多相态 Exp-6 势能 + Murnaghan 固相压缩)

---

## 二、当前成就

### 2.1 物理内核升级

| 版本 | 关键改进 | 验证状态 |
|------|---------|---------|
| **V7** | Schur-Rand 平衡求解器 + 对数域稳定性 | ✅ 通过 |
| **V8.1** | JWL Prior-Aware 拟合 + CJ 锚定 | ✅ 通过 |
| **V8.2** | 引入 Murnaghan 固相 EOS | ✅ 通过 |
| **V8.3** | 修正 N₂ 排斥半径 (5.95 → 3.88 Å) | ✅ 通过 |
| **V8.4** | **混合先验自动融合 + 诚实全参数验证** | **本版本** |

### 2.2 混合先验融合 (Automatic Prior Blending)

**问题**：JWL 参数拟合存在数学非唯一性，未知混合物（如 Octol, Comp B）的拟合不稳定。

**解决方案**：
```python
# 自动根据质量分数插值文献 JWL 系数
jwl_prior = blend_jwl_priors(components, fractions, LIT_JWL_DATA)
```

**验证结果**：
- Comp B (RDX/TNT 64/36): JWL A 系数误差 -7.0%，曲线 MAE **0.05 GPa** ✅
- Octol (HMX/TNT 75/25): JWL A 系数误差 -12.3%，曲线 MAE **0.08 GPa** ✅

### 2.3 全参数物理对标 (Phase 24 诚实披露)

建立了 **10 种炸药** 的全量验证协议：

| 炸药类型 | 覆盖范围 | D 误差范围 | P 误差范围 | JWL MAE |
|---------|---------|-----------|-----------|---------|
| 纯单体 (5) | HMX, RDX, PETN, TNT, NM | -10% ~ +1% | -10% ~ +2% | < 0.17 GPa |
| 混合 (3) | Comp B, Octol, LX-14 | -8% ~ -3% | -8% ~ +4% | < 0.09 GPa |
| 含铝 (2) | Tritonal, PBXN-109 | -1% ~ +2% | -6% ~ -3% | < 0.14 GPa |

**优秀成果**：
- ✅ **所有炸药的 JWL 曲线保真度优秀** (MAE < 0.2 GPa)
- ✅ **爆速/爆压误差在工程可接受范围** (< 10%)

---

## 三、当前技术瓶颈与咨询需求

### 3.1 【Critical】爆热 (Q) 计算的热力学困境

#### 问题描述

当前使用**简化化学计量假设**计算爆热：
```python
Q = (Hf_reactant - Hf_products_ideal) / Mass
```
假设产物为：CO₂, H₂O (gas), N₂, Al₂O₃, C (固)

#### 问题表现

| 炸药 | 预测 Q (MJ/kg) | 实验 Q (MJ/kg) | 误差 | 问题 |
|------|---------------|---------------|------|------|
| **RDX** | 5.63 | 5.53 | +1.8% | ✅ 优秀 |
| **HMX** | 5.57 | 6.19 | -10.0% | ⚠️ 可接受 |
| **TNT** | 2.32 | 4.69 | **-50.5%** | ❌ 严重偏低 |
| **PETN** | 0.78 | 5.81 | **-86.5%** | ❌ 崩溃 |
| **PBXN-109** | 11.68 | 7.2 | **+62.3%** | ❌ 含铝偏高 |

#### 根本原因分析

1. **缺氧炸药 (TNT, PETN)**：
   - 简化假设全部氧化为 CO₂/H₂O
   - 实际产物含大量 **CO, C(固), H₂**
   - 生成焓差异巨大（ΔHf[CO₂] = -393.5 kJ/mol vs ΔHf[CO] = -110.5 kJ/mol）

2. **含铝炸药 (PBXN-109)**：
   - Al + O₂ → Al₂O₃ 释放巨大能量 (ΔHf = -1675.7 kJ/mol)
   - 但 Al₂O₃ 生成焓值可能存在相态依赖（固态 vs 液态 vs 气态）

3. **热力学参考态不一致**：
   - 我们已经计算了 **CJ 产物的实际组成 (n_cj)**
   - 尝试使用 `compute_total_enthalpy(coeffs_all, T_cj, n_cj)` 计算实际产物焓
   - **但发现**：NASA 多项式的焓 `H(T)` 是相对于 298K 的焓差，而反应物的 `heat_of_formation` 是相对于单质的生成焓，**两者参考基准不一致**！

#### 咨询问题 1

**如何正确计算爆热 Q，使其既适用于缺氧炸药，又与 NASA 热力学数据库一致？**

**候选方案**：
- **方案 A**：为每个物种引入**标准生成焓** ΔHf°(298K)，统一参考基准
- **方案 B**：使用 **内能 E** 而非焓 H 来计算爆热（Hugoniot 曲线是基于内能的）
- **方案 C**：直接使用实验数据库（如 EXPLO5）的 Q-P 关系式拟合

您认为哪种方案更可靠？是否有标准的实现参考？

---

### 3.2 【High】爆速/爆压系统性偏低 (~10%)

#### 问题表现

| 炸药 | D 误差 | P 误差 | 潜在原因 |
|------|-------|-------|---------|
| **HMX** | -9.9% | -9.9% | N₂/CO₂ 排斥势能偏软 |
| **RDX** | -7.5% | +1.4% | 同上 |
| **LX-14** | -8.0% | -2.7% | 高 HMX 含量继承问题 |

#### 已实施修正

- ✅ 修正了 N₂ 排斥半径：r*[N₂] = 5.95 → **3.88 Å** (基于 V8.3 咨询反馈)
- ✅ 引入了 Murnaghan 固相 EOS 提升固体压缩精度

#### 咨询问题 2

**JCZ3 V8.4 的 N₂/CO₂ Exp-6 势能参数是否需要进一步校准？**

当前参数：
```
N₂:  ε/k = 95.05 K,  r* = 3.88 Å,  α = 13.0
CO₂: ε/k = 195.2 K,  r* = 4.486 Å, α = 12.5
```

**建议校准方向**：
- 增大 ε/k（加强排斥）
- 调整 α（改变势能曲线形状）

您认为应该优先调整哪个参数？是否有高压冲击实验数据可供参考？

---

### 3.3 【Medium】爆温 T 系统性偏高 (~10-15%)

#### 问题表现

几乎所有炸药的爆温都比实验值高 5-15%：
- TNT: +16.9%
- Comp B: +10.4%
- RDX: +8.0%

#### 物理机制猜想

**可能原因 1**：**热容 Cp(T) 在高温下偏低**
- NASA 多项式在 3000-5000 K 的外推精度不足
- 分子振动激发的高阶项未被充分考虑

**可能原因 2**：**解离反应吸热效应未考虑**
- 高温下 CO₂ → CO + O, H₂O → H₂ + O 等解离反应吸热
- 当前平衡求解器只考虑了分子产物，未引入原子态

#### 咨询问题 3

**如何改进高温 (3000-5000 K) 的热容模型？**

**候选方案**：
- 使用 **Gamma Law** 修正：Cp = Cp_NASA × (1 + γ·ΔT)
- 引入 **解离平衡**：增加 O, H, N 等原子态物种
- 使用更精确的 **分子振动配分函数**

您推荐哪种方法？

---

### 3.4 【Medium】含铝炸药的凝相热力学

#### 问题

PBXN-109 (RDX/Al/Binder) 的爆温偏差达到 **+26.9%**，爆热偏差 **+62.3%**。

#### 根本原因

当前 Al₂O₃ 凝相模型过于简化：
- 只使用 Murnaghan EOS 描述体积压缩
- **未考虑相变**：固态 α-Al₂O₃ ↔ 液态 ↔ 气态
- **未考虑温度依赖的热容**：Cp(T, P)

#### 咨询问题 4

**含铝炸药的 Al₂O₃ 产物应该如何建模？**

**关键疑问**：
- CJ 点 (P ~ 20-30 GPa, T ~ 3000-4000 K) 时，Al₂O₃ 是**固态、液态还是气态**？
- 是否需要引入 **Al₂O₃ 的状态方程** (如 ANEOS 或 Tillotson EOS)？
- 如何准确获取 Al₂O₃ 在高温高压下的热力学数据？

---

## 四、当前代码库状态

### 4.1 核心模块

| 模块 | 文件 | 功能 | 状态 |
|------|------|------|------|
| **API** | `pdu/api.py` | 用户接口 + 混合先验融合 | ✅ |
| **CJ 求解器** | `pdu/calibration/differentiable_cj_enhanced.py` | 多相态 Hugoniot + 等熵膨胀 | ✅ |
| **JWL 拟合** | `pdu/physics/jwl.py` | Prior-Aware Logarithmic Fitting | ✅ |
| **热力学** | `pdu/physics/thermo.py` | NASA 多项式 + 熵/焓计算 | ⚠️ 需改进 |
| **EOS** | `pdu/physics/eos.py` | JCZ3 Exp-6 + Murnaghan | ⚠️ 需校准 |

### 4.2 验证协议

- **标准测试集**：10 种炸药 (纯/混合/含铝)
- **验证参数**：D, P, T, Q, JWL (A, B, R₁, R₂, ω), JWL 曲线 MAE
- **数据来源**：LLNL, EXPLO5, 经典文献
- **诚实原则**：所有误差如实报告，失效点明确标注

### 4.3 Git 仓库

- **地址**: `https://github.com/chunliangjibit/pdu.git`
- **最新提交**: `fix: Corrected Heat of Detonation unit conversion (kJ/kg → MJ/kg)`
- **分支**: `main` (稳定版本)

---

## 五、请求专家指导的优先级排序

| 优先级 | 问题 | 影响范围 | 期望产出 |
|-------|------|---------|---------|
| **P0** | 爆热 Q 的热力学一致性 | TNT, PETN 等缺氧炸药 | 正确的 Q 计算公式 |
| **P1** | N₂/CO₂ 排斥势能校准 | HMX, RDX 等高能炸药 | 修正后的 ε/k, α 参数 |
| **P2** | 高温热容模型改进 | 所有炸药的爆温预测 | Cp(T) 修正方案 |
| **P3** | Al₂O₃ 凝相热力学 | 含铝炸药 | 高压相态数据或 EOS 参数 |

---

## 六、附录

### A. 完整验证结果

详见 `docs/v8_performance_report.md`

### B. 混合先验数据库

详见 `pdu/api.py` 中的 `LIT_JWL_DATA` 字典

### C. 联系方式

如需进一步讨论或提供实验数据，请通过以下方式联系：
- **项目仓库**: https://github.com/chunliangjibit/pdu
- **版本**: V8.4 (2026-01-28)

---

**感谢您的宝贵指导！我们承诺对所有建议进行严格验证，并在后续版本中如实报告改进效果。**
